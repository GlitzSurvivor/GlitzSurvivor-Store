<!DOCTYPE html>
<html>
<head>
<title>GlitzSurvivor Store</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial;background:#f2f2f2;}
header{background:#ff6600;color:white;padding:15px;text-align:center;}
.section{display:none;padding:20px;}
.products{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;}
.card{background:white;padding:15px;border-radius:10px;box-shadow:0 4px 8px rgba(0,0,0,0.1);text-align:center;}
.card img{width:100%;border-radius:8px;}
button{padding:7px 12px;border:none;border-radius:5px;cursor:pointer;margin-top:5px;}
.orange{background:#ff6600;color:white;}
.green{background:green;color:white;}
input{padding:8px;margin:5px;width:90%;}
.cart-item{display:flex;justify-content:space-between;margin-bottom:10px;}
.center{display:flex;justify-content:center;align-items:center;height:100vh;}
.box{background:white;padding:25px;border-radius:10px;text-align:center;box-shadow:0 4px 10px rgba(0,0,0,0.2);}
a{color:#ff6600;text-decoration:none;}
/* Floating Menu Button */
#menuBtn{position:fixed;right:20px;bottom:20px;background:#ff6600;color:white;border:none;padding:15px;border-radius:50%;font-size:18px;cursor:pointer;z-index:1000;box-shadow:0 4px 8px rgba(0,0,0,0.3);}
#bottomMenu{position:fixed;bottom:-200px;left:0;width:100%;background:white;box-shadow:0 -4px 10px rgba(0,0,0,0.2);transition:0.3s;padding:20px;z-index:999;}
#bottomMenu button{width:100%;margin:5px 0;}
</style>
</head>
<body>

<header>
<h2>My Professional eCommerce</h2>
</header>

<!-- Floating Menu Button -->
<button id="menuBtn" onclick="toggleMenu()">â˜° Menu</button>

<!-- Bottom Slide Menu -->
<div id="bottomMenu">
<button onclick="showSection('store')">Store</button>
<button onclick="showSection('cart')">Cart (<span id="cartCount">0</span>)</button>
<button id="adminBtn" onclick="showSection('admin')">Admin</button>
<button onclick="logout()">Logout</button>
</div>

<!-- LOGIN & REGISTER -->
<div id="login" class="center">
<div class="box">
<h3>Login</h3>
<input type="text" id="loginUser" placeholder="Username"><br>
<input type="password" id="loginPass" placeholder="Password"><br>
<button class="orange" onclick="login()">Login</button>
<p>Don't have an account? <a href="#" onclick="showRegister()">Register Here</a></p>

<div id="registerDiv" style="display:none;margin-top:20px;">
<h3>Register (Customer)</h3>
<input type="text" id="regUser" placeholder="Choose Username"><br>
<input type="password" id="regPass" placeholder="Choose Password"><br>
<input type="password" id="regConfirm" placeholder="Confirm Password"><br>
<button class="green" onclick="register()">Register</button>
</div>

<p id="msg"></p>
</div>
</div>

<!-- STORE -->
<div id="store" class="section">
<h3>Products</h3>
<div class="products" id="productList"></div>
</div>

<!-- CART -->
<div id="cart" class="section">
<h3>Your Cart</h3>
<div id="cartItems"></div>
<h3>Total: NPR <span id="total">0</span></h3>
<button class="green" onclick="checkout()">Checkout via WhatsApp</button>
</div>

<!-- ADMIN -->
<div id="admin" class="section">
<h3>Admin Panel</h3>
<input type="text" id="pname" placeholder="Product Name"><br>
<input type="number" id="pprice" placeholder="Price"><br>
<input type="file" id="pimagefile" accept="image/*"><br>
<button class="orange" onclick="addProduct()">Add Product</button>
</div>

<script>
// --- FLOATING MENU ---
let menuOpen=false;
function toggleMenu(){
  let menu=document.getElementById("bottomMenu");
  menu.style.bottom = menuOpen ? "-200px" : "0";
  menuOpen=!menuOpen;
}

// --- DATA ---
let products = JSON.parse(localStorage.getItem("products")) || [];
let cart = JSON.parse(localStorage.getItem("cart")) || [];
let users = JSON.parse(localStorage.getItem("users")) || [];

// --- REGISTER ---
function showRegister(){document.getElementById("registerDiv").style.display="block";}
function register(){
let u=document.getElementById("regUser").value;
let p=document.getElementById("regPass").value;
let c=document.getElementById("regConfirm").value;
if(u===""||p===""||c===""){document.getElementById("msg").innerText="Fill all fields!"; return;}
if(p!==c){document.getElementById("msg").innerText="Passwords do not match!"; return;}
if(users.find(user=>user.username===u)){document.getElementById("msg").innerText="Username exists!"; return;}
users.push({username:u,password:p,role:"customer"});
localStorage.setItem("users",JSON.stringify(users));
document.getElementById("msg").style.color="green";
document.getElementById("msg").innerText="Registration Successful! Login now.";
document.getElementById("registerDiv").style.display="none";
}

// --- LOGIN ---
function login(){
let u=document.getElementById("loginUser").value;
let p=document.getElementById("loginPass").value;
if(u==="Nicolus" && p==="nicolus098@"){localStorage.setItem("role","admin"); startApp(); return;}
let user = users.find(user=>user.username===u && user.password===p);
if(user){localStorage.setItem("role","customer"); localStorage.setItem("currentUser",u); startApp();}
else{document.getElementById("msg").innerText="Invalid login!";}
}

// --- START APP ---
function startApp(){
document.getElementById("login").style.display="none";
if(localStorage.getItem("role")==="customer"){document.getElementById("adminBtn").style.display="none";}
showSection("store"); displayProducts(); updateCart();
}

// --- LOGOUT ---
function logout(){localStorage.removeItem("role"); localStorage.removeItem("currentUser"); location.reload();}

// --- NAVIGATION ---
function showSection(id){
document.querySelectorAll(".section").forEach(s=>s.style.display="none");
document.getElementById(id).style.display="block";
toggleMenu(); // close menu after clicking
}

// --- PRODUCTS ---
function displayProducts(){
let list = document.getElementById("productList");
list.innerHTML = "";
products.forEach((p, i) => {
    list.innerHTML += `
    <div class="card">
        <img src="${p.image}">
        <h4>${p.name}</h4>
        <p>NPR ${p.price}</p>
        <button class="green" onclick="addToCart(${i})">Add to Cart</button>
        ${localStorage.getItem("role")==="admin" ? `<button class="orange" onclick="deleteProduct(${i})">Delete</button>` : ""}
    </div>`;
});
localStorage.setItem("products", JSON.stringify(products));
}

// --- ADD PRODUCT ---
function addProduct(){
if(localStorage.getItem("role")!=="admin"){alert("Only Admin!"); return;}
let name=document.getElementById("pname").value;
let price=document.getElementById("pprice").value;
let file=document.getElementById("pimagefile").files[0];
if(!name || !price || !file){alert("Fill all fields & select an image!"); return;}
let reader = new FileReader();
reader.onload = function(e){
    products.push({name,price:Number(price),image:e.target.result});
    displayProducts();
    alert("Product Added!");
};
reader.readAsDataURL(file);
}

// --- DELETE PRODUCT ---
function deleteProduct(index){
if(localStorage.getItem("role") !== "admin"){ alert("Only Admin!"); return; }
if(confirm("Are you sure you want to delete this product?")){
    products.splice(index,1);
    localStorage.setItem("products",JSON.stringify(products));
    displayProducts();
}
}

// --- CART ---
function addToCart(i){
let item=products[i];
let existing=cart.find(p=>p.name===item.name);
if(existing){existing.qty++;}
else{cart.push({...item,qty:1});}
saveCart();
}
function saveCart(){localStorage.setItem("cart",JSON.stringify(cart)); updateCart();}
function updateCart(){
let div=document.getElementById("cartItems"); div.innerHTML=""; let total=0;
cart.forEach((item,i)=>{
total+=item.price*item.qty;
div.innerHTML+=`<div class="cart-item">${item.name} x ${item.qty}<div><button onclick="changeQty(${i},1)">+</button> <button onclick="changeQty(${i},-1)">-</button></div></div>`;
});
document.getElementById("total").innerText=total;
document.getElementById("cartCount").innerText=cart.length;
}
function changeQty(i,change){cart[i].qty+=change; if(cart[i].qty<=0){cart.splice(i,1);} saveCart();}

// --- CHECKOUT VIA WHATSAPP ---
function checkout(){
if(cart.length===0){alert("Cart is empty!"); return;}
let message = "New Order from eCommerce:\n\n";
cart.forEach(item=>{
    message += `${item.name} x ${item.qty} = NPR ${item.price*item.qty}\n`;
});
let total = cart.reduce((sum,item)=>sum+item.price*item.qty,0);
message += `\nTotal: NPR ${total}`;
let encodedMessage = encodeURIComponent(message);
let yourNumber = "9767797783"; // <-- Replace with your WhatsApp number
let whatsappURL = `https://wa.me/${yourNumber}?text=${encodedMessage}`;
window.open(whatsappURL, "_blank");

// Clear cart
cart = [];
localStorage.removeItem("cart");
updateCart();
showSection("store");
}

// --- AUTO LOGIN ---
if(localStorage.getItem("role")){startApp();}
</script>

</body>
</html>

